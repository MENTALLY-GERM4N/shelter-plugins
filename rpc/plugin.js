(()=>{var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var m=Object.prototype.hasOwnProperty;var y=(a,e)=>{for(var t in e)c(a,t,{get:e[t],enumerable:!0})},h=(a,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of g(e))!m.call(a,i)&&i!==t&&c(a,i,{get:()=>e[i],enumerable:!(s=p(e,i))||s.enumerable});return a};var f=a=>h(c({},"__esModule",{value:!0}),a);var d={};y(d,{onLoad:()=>_});var{flux:{dispatcher:v,stores:{ApplicationStore:u}},http:o}=shelter,r={},n={},l=async(a,e)=>{if(!n[a])try{if(o.get){let s=await o.get(`/oauth2/applications/${a}/assets`);if(s.status!==200)return console.error("Error fetching resources"),null;n[a]=s.body}}catch(s){return console.error("Request failed",s),null}let t=n[a].find(s=>s.name===e);return t?t.id:null};function _(){let a=new WebSocket("ws://127.0.0.1:1337");a&&(a.onmessage=async e=>{let t=JSON.parse(e.data);if(t.activity?.assets?.large_image.startsWith("https://")?t.activity.assets.large_image=`https://images-ext-1.discordapp.net/external/${t.activity.assets.large_image.replace("https://","https/")}?format=webp&width=300&height=300`:(t.activity?.assets?.large_image&&(t.activity.assets.large_image=await l(t.activity.application_id,t.activity.assets.large_image)),t.activity?.assets?.small_image&&(t.activity.assets.small_image=await l(t.activity.application_id,t.activity.assets.small_image))),t.activity){let s=t.activity.application_id;r[s]||(r[s]=await u.getApplication(s)||"Unknown");let i=r[s];t.activity.name||(t.activity.name=i.name)}console.warn(t),v.dispatch({type:"LOCAL_ACTIVITY_UPDATE",...t})})}return f(d);})();
